<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.sp.app.mapper.PackageMapper">
	
	<select id="findByPackage" parameterType="Long" resultType="com.sp.app.model.Package">
		SELECT price,content FROM package WHERE packageNum = #{packageNum}
	</select>
	
	<insert id="insertsubStatus" parameterType="com.sp.app.model.SubStatus">
	INSERT INTO subStatus(subNum,subMonth,payDate,payMethod,totalPay,memberId)
	VALUES(subStatus_seq.NEXTVAL,SYSDATE,#{payMethod},#{totalPay},#{memberId})
	</insert>
	
	<insert id="insertsubItem" parameterType="com.sp.app.model.subItem">
    INSERT INTO subItem (itemNum, itemPrice, count, subNum, productNum)
    VALUES (
        subItem_seq.NEXTVAL,
        (
            SELECT unitPrice * #{count}
            FROM ProductDetail
            WHERE productNum = #{productNum}
        ),
        #{count},
        #{subNum},
        #{productNum}
    )
	</insert>
	
	<insert id="insertsubPackage" parameterType="com.sp.app.model.Package">
	INSERT INTO subPackage(subPackageNum,subNum,packageNum,packagePrice, count)
	VALUES(subPackage_seq.NEXTVAL,#{suvNum},#{packageNum},
		(
			SELECT price * #{count}
			FROM package
			WHERE packageNum = #{packageNum}
		) 
	)
	</insert>
	
	
</mapper>